<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpotClaim - Instant Insurance Claims</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .hidden {
            display: none !important;
        }

        /* Utility Classes */
        .min-h-screen {
            min-height: 100vh;
        }

        .flex {
            display: flex;
        }

        .items-center {
            align-items: center;
        }

        .justify-center {
            justify-content: center;
        }

        .text-center {
            text-align: center;
        }

        .bg-gradient-red {
            background: linear-gradient(to bottom right, #dc2626, #991b1b);
        }

        .bg-gradient-green {
            background: linear-gradient(to bottom right, #16a34a, #15803d);
        }

        .bg-gradient-yellow {
            background: linear-gradient(to bottom right, #ca8a04, #a16207);
        }

        .bg-gray-900 {
            background-color: #07090f;
        }

        .bg-gray-800 {
            background-color: #0f1419;
        }

        .bg-gray-700 {
            background-color: #1a1f2e;
        }

        .text-white {
            color: white;
        }

        .text-gray-400 {
            color: #9ca3af;
        }

        .text-gray-300 {
            color: #d1d5db;
        }

        .text-blue-400 {
            color: #60a5fa;
        }

        .rounded-xl {
            border-radius: 0.75rem;
        }

        .rounded-2xl {
            border-radius: 1rem;
        }

        .rounded-3xl {
            border-radius: 1.5rem;
        }

        .p-4 {
            padding: 1rem;
        }

        .p-6 {
            padding: 1.5rem;
        }

        .mb-2 {
            margin-bottom: 0.5rem;
        }

        .mb-4 {
            margin-bottom: 1rem;
        }

        .mb-6 {
            margin-bottom: 1.5rem;
        }

        .mb-8 {
            margin-bottom: 2rem;
        }

        .mb-12 {
            margin-bottom: 3rem;
        }

        .mt-2 {
            margin-top: 0.5rem;
        }

        .mt-4 {
            margin-top: 1rem;
        }

        .mt-6 {
            margin-top: 1.5rem;
        }

        .mt-12 {
            margin-top: 3rem;
        }

        /* Emergency Screen */
        .emergency-screen {
            min-height: 100vh;
            background: linear-gradient(to bottom right, #dc2626, #991b1b);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        .emergency-icon {
            width: 8rem;
            height: 8rem;
            margin: 0 auto 1rem;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        @keyframes bounce {
            0%, 100% {
                transform: translateY(-5%);
                animation-timing-function: cubic-bezier(0.8, 0, 1, 1);
            }
            50% {
                transform: translateY(0);
                animation-timing-function: cubic-bezier(0, 0, 0.2, 1);
            }
        }

        .emergency-button {
            background: white;
            color: #dc2626;
            font-weight: 900;
            font-size: 1.5rem;
            padding: 2rem 4rem;
            border-radius: 1.5rem;
            border: none;
            cursor: pointer;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            animation: bounce 1s infinite;
            transition: transform 0.2s;
        }

        .emergency-button:hover {
            transform: scale(1.05);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
            margin-top: 3rem;
            color: white;
        }

        .stat-number {
            font-size: 2.25rem;
            font-weight: bold;
        }

        .stat-label {
            font-size: 0.875rem;
            opacity: 0.8;
        }

        /* Form Screens */
        .form-container {
            min-height: 100vh;
            background-color: #07090f;
            color: white;
            padding: 1.5rem;
        }

        .form-wrapper {
            max-width: 42rem;
            margin: 0 auto;
        }

        .form-header {
            margin-bottom: 1.5rem;
        }

        .form-title {
            font-size: 1.875rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .form-card {
            background-color: #0f1419;
            border-radius: 1rem;
            padding: 1.5rem;
        }

        .form-group {
            margin-bottom: 1.25rem;
        }

        .form-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            color: #d1d5db;
            margin-bottom: 0.5rem;
        }

        .form-input {
            width: 100%;
            padding: 0.75rem 1rem;
            background-color: #1a1f2e;
            border: 1px solid #2a3340;
            border-radius: 0.5rem;
            color: white;
            font-size: 1rem;
        }

        .form-input::placeholder {
            color: #6b7280;
        }

        .form-input:focus {
            outline: none;
            ring: 2px;
            ring-color: #3b82f6;
            border-color: transparent;
        }

        .button-group {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
        }

        .vehicle-button {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            padding: 1rem;
            border-radius: 0.5rem;
            border: 2px solid;
            background-color: #1a1f2e;
            border-color: #2a3340;
            color: #d1d5db;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: bold;
        }

        .vehicle-button:hover {
            border-color: #3b4552;
        }

        .vehicle-button.active {
            background-color: #2563eb;
            border-color: #2563eb;
            color: white;
        }

        .location-locked {
            display: flex;
            align-items: start;
            gap: 0.75rem;
            padding: 1rem;
            background-color: rgba(22, 163, 74, 0.3);
            border: 1px solid #16a34a;
            border-radius: 0.5rem;
        }

        .btn-primary {
            background-color: #2563eb;
            color: white;
            font-weight: bold;
            padding: 1rem;
            border-radius: 0.75rem;
            border: none;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .btn-primary:hover {
            background-color: #1d4ed8;
        }

        .btn-primary:disabled {
            background-color: #1a1f2e;
            color: #4b5563;
            cursor: not-allowed;
        }

        .btn-secondary {
            background-color: #1a1f2e;
            color: white;
            font-weight: bold;
            padding: 1rem;
            border-radius: 0.75rem;
            border: none;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .btn-secondary:hover {
            background-color: #2a3340;
        }

        .button-row {
            display: flex;
            gap: 0.75rem;
            margin-top: 1.5rem;
        }

        .button-row button {
            flex: 1;
        }

        /* Media Upload */
        .media-section {
            background-color: #0f1419;
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .media-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
        }

        .media-title {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.25rem;
            font-weight: bold;
        }

        .photo-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .photo-item {
            position: relative;
        }

        .photo-item img {
            width: 100%;
            height: 8rem;
            object-fit: cover;
            border-radius: 0.5rem;
        }

        .photo-badge {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background-color: #16a34a;
            color: white;
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border-radius: 9999px;
            font-weight: bold;
        }

        .photo-timestamp {
            position: absolute;
            bottom: 0.5rem;
            left: 0.5rem;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
        }

        .video-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            background-color: #1a1f2e;
            padding: 0.75rem;
            border-radius: 0.5rem;
            margin-bottom: 0.75rem;
        }

        .requirements-box {
            background-color: rgba(37, 99, 235, 0.3);
            border: 1px solid #2563eb;
            border-radius: 0.75rem;
            padding: 1rem;
            margin-bottom: 1.5rem;
        }

        .requirements-list {
            list-style: none;
            font-size: 0.875rem;
            color: #bfdbfe;
        }

        .requirements-list li {
            margin-bottom: 0.25rem;
        }

        .requirements-list li.complete {
            color: #4ade80;
        }

        /* Document Section */
        .document-choice {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .doc-or {
            text-align: center;
            color: #9ca3af;
            font-size: 0.875rem;
        }

        .document-item {
            background-color: #1a1f2e;
            padding: 0.75rem;
            border-radius: 0.5rem;
        }

        .document-content {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .doc-icon {
            font-size: 1.875rem;
        }

        .doc-verified {
            font-size: 0.75rem;
            font-weight: bold;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            background-color: rgba(34, 197, 94, 0.2);
            color: #4ade80;
        }

        .upload-button {
            width: 100%;
            background-color: #1a1f2e;
            border: 2px dashed #2a3340;
            color: #d1d5db;
            font-weight: bold;
            padding: 0.75rem;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .upload-button:hover {
            background-color: #2a3340;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            z-index: 50;
        }

        .modal-content {
            background-color: #0f1419;
            border-radius: 1rem;
            padding: 1.5rem;
            max-width: 28rem;
            width: 100%;
        }

        /* Analyzing Screen */
        .analyzing-screen {
            min-height: 100vh;
            background-color: #07090f;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1.5rem;
        }

        .analyzing-spinner {
            width: 8rem;
            height: 8rem;
            border: 8px solid #2563eb;
            border-top-color: transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 2rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .analyzing-checks {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            text-align: left;
            background-color: #0f1419;
            border-radius: 1rem;
            padding: 1.5rem;
        }

        .check-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .check-icon {
            width: 1.5rem;
            height: 1.5rem;
            background-color: #2563eb;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Result Screen */
        .result-screen {
            min-height: 100vh;
            padding: 1.5rem;
        }

        .result-icon {
            width: 8rem;
            height: 8rem;
            margin: 0 auto 1rem;
        }

        .result-icon.bounce {
            animation: bounce 1s infinite;
        }

        .result-card {
            background-color: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            color: white;
        }

        .result-card-white {
            background-color: white;
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
        }

        .check-result {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 0.75rem;
        }

        .check-label {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .damage-cost {
            text-align: center;
        }

        .damage-amount {
            font-size: 3rem;
            font-weight: 900;
            color: #111827;
        }

        .garage-info {
            display: flex;
            align-items: start;
            gap: 1rem;
        }

        .btn-success {
            width: 100%;
            background-color: white;
            color: #15803d;
            font-weight: 900;
            font-size: 1.25rem;
            padding: 1.25rem;
            border-radius: 1rem;
            border: none;
            cursor: pointer;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s;
        }

        .btn-success:hover {
            transform: scale(1.05);
        }

        .info-box {
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 1rem;
            padding: 1rem;
            color: white;
        }

        .alert-box {
            background-color: rgba(34, 197, 94, 0.1);
            border: 2px solid rgb(134, 239, 172);
            border-radius: 0.5rem;
            padding: 0.75rem;
            margin-top: 1rem;
        }

        .tow-truck-box {
            background-color: rgba(59, 130, 246, 0.1);
            border: 2px solid #3b82f6;
            border-radius: 0.5rem;
            padding: 0.75rem;
            margin-top: 1rem;
        }

        .icon {
            width: 1.25rem;
            height: 1.25rem;
            display: inline-block;
        }

        .icon-lg {
            width: 2rem;
            height: 2rem;
        }

        .summary-detail {
            margin-bottom: 1rem;
            padding: 1rem;
            background-color: #0f1419;
            border-radius: 0.5rem;
        }

        .flex-between {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .space-y-3 > * + * {
            margin-top: 0.75rem;
        }

        .space-y-5 > * + * {
            margin-top: 1.25rem;
        }

        .btn-green {
            background-color: #16a34a;
            color: white;
            font-weight: bold;
            padding: 1rem;
            border-radius: 0.75rem;
            border: none;
            cursor: pointer;
            animation: pulse 2s infinite;
        }

        .btn-green:hover {
            background-color: #15803d;
        }

        .btn-green:disabled {
            background-color: #1a1f2e;
            color: #4b5563;
            cursor: not-allowed;
            animation: none;
        }

        .btn-purple {
            background-color: #9333ea;
            color: white;
            font-weight: bold;
            padding: 1rem;
            border-radius: 0.75rem;
            border: none;
            cursor: pointer;
        }

        .btn-purple:hover {
            background-color: #7e22ce;
        }

        .btn-border {
            width: 100%;
            border: 2px solid white;
            background: transparent;
            color: white;
            font-weight: bold;
            padding: 0.75rem;
            border-radius: 0.75rem;
            cursor: pointer;
        }

        .btn-border:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        input[type="file"] {
            display: none;
        }

        button {
            cursor: pointer;
        }

        select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%239ca3af' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 0.5rem center;
            background-repeat: no-repeat;
            background-size: 1.5em 1.5em;
            padding-right: 2.5rem;
        }

        .spinner {
            width: 1.25rem;
            height: 1.25rem;
            border: 2px solid #6b7280;
            border-top-color: transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            display: inline-block;
        }

        @media (max-width: 640px) {
            .emergency-button {
                font-size: 1.25rem;
                padding: 1.5rem 3rem;
            }
           
            .stat-number {
                font-size: 1.875rem;
            }
        }
    </style>
</head>
<body>
    <div id="app"></div>

    <script>
        // SVG Icons as strings
        const icons = {
            alertTriangle: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>',
            camera: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"></path><circle cx="12" cy="13" r="3"></circle></svg>',
            mapPin: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>',
            checkCircle: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>',
            shield: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg>',
            clock: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>',
            video: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m22 8-6 4 6 4V8Z"></path><rect x="2" y="6" width="14" height="12" rx="2" ry="2"></rect></svg>',
            car: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2"></path><circle cx="7" cy="17" r="2"></circle><path d="M9 17h6"></path><circle cx="17" cy="17" r="2"></circle></svg>',
            bike: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="5.5" cy="17.5" r="3.5"></circle><circle cx="18.5" cy="17.5" r="3.5"></circle><path d="M15 6a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm-3 11.5V14l-3-3 4-3 2 3h2"></path></svg>',
            xCircle: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg>',
            navigation: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 11 22 2 13 21 11 13 3 11"></polygon></svg>',
            truck: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="1" y="3" width="15" height="13"></rect><polygon points="16 8 20 8 23 11 23 16 16 16 16 8"></polygon><circle cx="5.5" cy="18.5" r="2.5"></circle><circle cx="18.5" cy="18.5" r="2.5"></circle></svg>'
        };

        // State management
        let state = {
            screen: 'emergency',
            formData: {
                name: '',
                vehicleNumber: '',
                vehicleType: '',
                policyNumber: '',
                policyCompany: '',
                location: null
            },
            photos: [],
            videos: [],
            documents: {
                rc: null,
                license: null,
                policy: null,
                additional: []
            },
            analyzing: false,
            result: null,
            gettingGPS: false,
            showAddDocModal: false,
            newDocName: '',
            extractingFromLocker: false,
            showDocumentChoice: true
        };

        // Helper functions
        function createIcon(iconName, className = 'icon') {
            const div = document.createElement('div');
            div.innerHTML = icons[iconName];
            div.className = className;
            div.style.display = 'inline-block';
            return div.innerHTML;
        }

        function handleInputChange(field, value) {
            state.formData[field] = value;
        }

        function getGPSLocation() {
            state.gettingGPS = true;
            render();
           
            setTimeout(() => {
                state.formData.location = {
                    lat: 12.9716,
                    lng: 77.5946,
                    address: "PCCOER, Ravet",
                    accuracy: 15,
                    timestamp: new Date()
                };
                state.gettingGPS = false;
                render();
            }, 2000);
        }

        function handlePhotoCapture(e) {
            const files = Array.from(e.target.files);
            let loadedCount = 0;
           
            files.forEach(file => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    state.photos.push({
                        src: e.target.result,
                        timestamp: new Date(),
                        file: file
                    });
                    loadedCount++;
                    if (loadedCount === files.length) {
                        render();
                    }
                };
                reader.readAsDataURL(file);
            });
        }

        function handleVideoCapture(e) {
            const files = Array.from(e.target.files);
            let loadedCount = 0;
           
            files.forEach(file => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    state.videos.push({
                        src: e.target.result,
                        timestamp: new Date(),
                        file: file,
                        name: file.name
                    });
                    loadedCount++;
                    if (loadedCount === files.length) {
                        render();
                    }
                };
                reader.readAsDataURL(file);
            });
        }

        function handleDocumentUpload(type, e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const docData = {
                        src: e.target.result,
                        timestamp: new Date(),
                        file: file,
                        name: file.name,
                        verified: Math.random() > 0.1
                    };

                    if (type === 'additional') {
                        state.documents.additional.push({ ...docData, customName: state.newDocName });
                        state.newDocName = '';
                        state.showAddDocModal = false;
                    } else {
                        state.documents[type] = docData;
                    }
                    render();
                };
                reader.readAsDataURL(file);
            }
        }

        function extractFromLocker() {
            state.extractingFromLocker = true;
            state.showDocumentChoice = false;
            render();
           
            setTimeout(() => {
                state.documents.rc = {
                    name: 'RC_' + state.formData.vehicleNumber + '.pdf',
                    timestamp: new Date(),
                    verified: true,
                    extracted: true
                };
                render();
            }, 500);

            setTimeout(() => {
                state.documents.license = {
                    name: 'DL_' + state.formData.name.split(' ')[0] + '.pdf',
                    timestamp: new Date(),
                    verified: true,
                    extracted: true
                };
                render();
            }, 1000);

            setTimeout(() => {
                state.documents.policy = {
                    name: 'Policy_' + state.formData.policyNumber + '.pdf',
                    timestamp: new Date(),
                    verified: true,
                    extracted: true
                };
                state.extractingFromLocker = false;
                render();
            }, 1500);
        }

        function runFraudChecks() {
            state.analyzing = true;
            state.screen = 'analyzing';
            render();

            setTimeout(() => {
                const now = new Date();
                const mediaAge = state.photos.length > 0 ? (now - state.photos[0].timestamp) / 1000 / 60 : 0;
               
                const gpsCheck = state.formData.location !== null;
                const freshnessCheck = mediaAge < 30;
                const damageCheck = Math.random() > 0.2;
               
                const checksCount = [gpsCheck, freshnessCheck, damageCheck].filter(Boolean).length;
                
                // Limit damage cost to maximum 12000
                const damageCost = Math.min(Math.floor(Math.random() * 10000) + 2000, 12000);
               
                let status, message, action;
               
                if (checksCount === 3) {
                    status = 'approved';
                    message = 'INSTANT APPROVED!';
                    action = 'Garage dispatched automatically';
                } else if (checksCount === 2) {
                    status = 'review';
                    message = 'Quick Call Needed';
                    action = 'Support will call in 5 minutes';
                } else {
                    status = 'blocked';
                    message = 'CLAIM BLOCKED';
                    action = 'Fraud detected - Go to accident spot';
                }

                state.result = {
                    status,
                    message,
                    action,
                    damageCost,
                    checks: {
                        gps: gpsCheck,
                        freshness: freshnessCheck,
                        damage: damageCheck
                    },
                    checksCount,
                    garage: 'ABC Auto Repair',
                    distance: '2.1 km',
                    eta: '15 mins'
                };

                state.analyzing = false;
                state.screen = 'result';
                render();
            }, 4000);
        }

        function reset() {
            state = {
                screen: 'emergency',
                formData: {
                    name: '',
                    vehicleNumber: '',
                    vehicleType: '',
                    policyNumber: '',
                    policyCompany: '',
                    location: null
                },
                photos: [],
                videos: [],
                documents: {
                    rc: null,
                    license: null,
                    policy: null,
                    additional: []
                },
                analyzing: false,
                result: null,
                gettingGPS: false,
                showAddDocModal: false,
                newDocName: '',
                extractingFromLocker: false,
                showDocumentChoice: true
            };
            render();
        }

        function canProceedFromDetails() {
            return state.formData.name &&
                   state.formData.vehicleNumber &&
                   state.formData.vehicleType &&
                   state.formData.policyNumber &&
                   state.formData.policyCompany &&
                   state.formData.location;
        }

        function canProceedFromMedia() {
            const hasMedia = state.photos.length >= 4 || state.videos.length >= 1;
            const hasRequiredDocs = state.documents.rc && state.documents.license && state.documents.policy;
            return hasMedia && hasRequiredDocs;
        }

        // Render functions
        function renderEmergencyScreen() {
            return `
                <div class="emergency-screen">
                    <div style="max-width: 600px;">
                        <div class="emergency-icon">
                            ${createIcon('alertTriangle', 'emergency-icon')}
                        </div>
                        <h1 style="font-size: 3rem; font-weight: 900; color: white; margin-bottom: 1rem;">ACCIDENT?</h1>
                        <p style="font-size: 1.25rem; color: #fecaca; margin-bottom: 3rem;">Get your claim approved in 90 seconds</p>
                       
                        <button class="emergency-button" onclick="state.screen = 'details'; render();">
                            üö® SPOTCLAIM NOW
                        </button>

                        <div class="stats-grid">
                            <div>
                                <div class="stat-number">90s</div>
                                <div class="stat-label">Total Time</div>
                            </div>
                            <div>
                                <div class="stat-number">3</div>
                                <div class="stat-label">Fraud Checks</div>
                            </div>
                            <div>
                                <div class="stat-number">0</div>
                                <div class="stat-label">Paperwork</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderDetailsScreen() {
            return `
                <div class="form-container">
                    <div class="form-wrapper">
                        <div class="form-header">
                            <h2 class="form-title">Incident Details</h2>
                            <p class="text-gray-400">Fill your information carefully</p>
                            <div class="mt-2 text-blue-400" style="font-size: 0.875rem;">Step 1 of 3</div>
                        </div>

                        <div class="form-card space-y-5">
                            <div class="form-group">
                                <label class="form-label">Your Name *</label>
                                <input
                                    type="text"
                                    class="form-input"
                                    value="${state.formData.name}"
                                    placeholder="Enter your full name"
                                    onchange="handleInputChange('name', this.value); render();"
                                    onkeyup="handleInputChange('name', this.value);"
                                />
                            </div>

                            <div class="form-group">
                                <label class="form-label">Vehicle Type *</label>
                                <div class="button-group">
                                    <button
                                        class="vehicle-button ${state.formData.vehicleType === 'car' ? 'active' : ''}"
                                        onclick="handleInputChange('vehicleType', 'car'); render();"
                                    >
                                        ${createIcon('car', 'icon-lg')}
                                        <span>Car</span>
                                    </button>
                                    <button
                                        class="vehicle-button ${state.formData.vehicleType === 'bike' ? 'active' : ''}"
                                        onclick="handleInputChange('vehicleType', 'bike'); render();"
                                    >
                                        ${createIcon('bike', 'icon-lg')}
                                        <span>Bike</span>
                                    </button>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Vehicle Number *</label>
                                <input
                                    type="text"
                                    class="form-input"
                                    style="text-transform: uppercase;"
                                    value="${state.formData.vehicleNumber}"
                                    placeholder="e.g., MH12AB1234"
                                    onchange="handleInputChange('vehicleNumber', this.value.toUpperCase()); render();"
                                    onkeyup="handleInputChange('vehicleNumber', this.value.toUpperCase());"
                                />
                            </div>

                            <div class="form-group">
                                <label class="form-label">Insurance Company *</label>
                                <select
                                    class="form-input"
                                    value="${state.formData.policyCompany}"
                                    onchange="handleInputChange('policyCompany', this.value); render();"
                                >
                                    <option value="">Select insurance company</option>
                                    <option value="ICICI Lombard">ICICI Lombard</option>
                                    <option value="HDFC ERGO">HDFC ERGO</option>
                                    <option value="Bajaj Allianz">Bajaj Allianz</option>
                                    <option value="Tata AIG">Tata AIG</option>
                                    <option value="Reliance General">Reliance General</option>
                                    <option value="New India Assurance">New India Assurance</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Policy Number *</label>
                                <input
                                    type="text"
                                    class="form-input"
                                    value="${state.formData.policyNumber}"
                                    placeholder="Enter policy number"
                                    onchange="handleInputChange('policyNumber', this.value); render();"
                                    onkeyup="handleInputChange('policyNumber', this.value);"
                                />
                            </div>

                            <div class="form-group">
                                <label class="form-label">Accident Location *</label>
                                ${state.formData.location ? `
                                    <div class="location-locked">
                                        ${createIcon('mapPin', 'icon-lg')}
                                        <div style="flex: 1;">
                                            <div style="color: #4ade80; font-weight: bold;">GPS Locked ‚úì</div>
                                            <div style="font-size: 0.875rem; color: #d1d5db;">${state.formData.location.address}</div>
                                            <div style="font-size: 0.75rem; color: #6b7280;">Accuracy: ${state.formData.location.accuracy}m</div>
                                        </div>
                                    </div>
                                ` : `
                                    <button
                                        class="btn-primary"
                                        style="width: 100%; display: flex; align-items: center; justify-content: center; gap: 0.75rem;"
                                        onclick="getGPSLocation()"
                                        ${state.gettingGPS ? 'disabled' : ''}
                                    >
                                        ${state.gettingGPS ? `
                                            <span class="spinner"></span>
                                            <span>Getting GPS Location...</span>
                                        ` : `
                                            ${createIcon('mapPin')}
                                            <span>Get Current Location</span>
                                        `}
                                    </button>
                                `}
                            </div>
                        </div>

                        <div class="button-row">
                            <button class="btn-secondary" onclick="state.screen = 'emergency'; render();">
                                ‚Üê Back
                            </button>
                            <button
                                class="btn-primary"
                                onclick="state.screen = 'capture'; render();"
                                ${!canProceedFromDetails() ? 'disabled' : ''}
                            >
                                Next: Upload Media ‚Üí
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderCaptureScreen() {
            return `
                <div class="form-container">
                    <div class="form-wrapper">
                        <div class="form-header">
                            <h2 class="form-title">Upload Damage Evidence</h2>
                            <p class="text-gray-400">Photos and videos of the damage</p>
                            <div class="mt-2 text-blue-400" style="font-size: 0.875rem;">Step 2 of 3</div>
                        </div>

                        <div class="summary-detail">
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.75rem; font-size: 0.875rem;">
                                <div>
                                    <span class="text-gray-400">Name:</span>
                                    <span style="margin-left: 0.5rem; font-weight: bold;">${state.formData.name}</span>
                                </div>
                                <div>
                                    <span class="text-gray-400">Vehicle:</span>
                                    <span style="margin-left: 0.5rem; font-weight: bold;">${state.formData.vehicleNumber}</span>
                                </div>
                                <div>
                                    <span class="text-gray-400">Type:</span>
                                    <span style="margin-left: 0.5rem; font-weight: bold; text-transform: capitalize;">${state.formData.vehicleType}</span>
                                </div>
                                <div>
                                    <span class="text-gray-400">Insurer:</span>
                                    <span style="margin-left: 0.5rem; font-weight: bold;">${state.formData.policyCompany}</span>
                                </div>
                            </div>
                        </div>

                        <!-- Photos Section -->
                        <div class="media-section">
                            <div class="media-header">
                                <h3 class="media-title">
                                    ${createIcon('camera', 'icon-lg')}
                                    Damage Photos
                                </h3>
                                <span style="font-size: 0.875rem; color: #9ca3af;">${state.photos.length} uploaded</span>
                            </div>

                            ${state.photos.length > 0 ? `
                                <div class="photo-grid">
                                    ${state.photos.map((photo, idx) => `
                                        <div class="photo-item">
                                            <img src="${photo.src}" alt="Damage ${idx + 1}" />
                                            <div class="photo-badge">‚úì Photo ${idx + 1}</div>
                                            <div class="photo-timestamp">${Math.floor((new Date() - photo.timestamp) / 1000)}s ago</div>
                                        </div>
                                    `).join('')}
                                </div>
                            ` : ''}

                            <input
                                type="file"
                                id="photoInput"
                                accept="image/*"
                                capture="environment"
                                multiple
                                onchange="handlePhotoCapture(event)"
                            />
                            <button
                                class="btn-primary"
                                style="width: 100%; display: flex; align-items: center; justify-content: center; gap: 0.5rem;"
                                onclick="document.getElementById('photoInput').click()"
                            >
                                ${createIcon('camera')}
                                ${state.photos.length === 0 ? 'Take Photos (Min 4)' : 'Add More Photos'}
                            </button>

                            ${state.photos.length > 0 && state.photos.length < 4 ? `
                                <p style="color: #fbbf24; font-size: 0.875rem; margin-top: 0.5rem; text-align: center;">
                                    ‚ö†Ô∏è Minimum 4 photos required (or 1 video)
                                </p>
                            ` : ''}
                        </div>

                        <!-- Videos Section -->
                        <div class="media-section">
                            <div class="media-header">
                                <h3 class="media-title">
                                    ${createIcon('video', 'icon-lg')}
                                    Damage Videos
                                </h3>
                                <span style="font-size: 0.875rem; color: #9ca3af;">${state.videos.length} uploaded</span>
                            </div>

                            ${state.videos.length > 0 ? `
                                <div style="margin-bottom: 1rem;">
                                    ${state.videos.map((video, idx) => `
                                        <div class="video-item">
                                            ${createIcon('video', 'icon-lg')}
                                            <div style="flex: 1;">
                                                <div style="font-weight: bold; font-size: 0.875rem;">Video ${idx + 1}</div>
                                                <div style="font-size: 0.75rem; color: #9ca3af;">${video.name}</div>
                                                <div style="font-size: 0.75rem; color: #6b7280;">
                                                    ${Math.floor((new Date() - video.timestamp) / 1000)}s ago
                                                </div>
                                            </div>
                                            <div class="photo-badge">‚úì</div>
                                        </div>
                                    `).join('')}
                                </div>
                            ` : ''}

                            <input
                                type="file"
                                id="videoInput"
                                accept="video/*"
                                capture="environment"
                                multiple
                                onchange="handleVideoCapture(event)"
                            />
                            <button
                                class="btn-purple"
                                style="width: 100%; display: flex; align-items: center; justify-content: center; gap: 0.5rem;"
                                onclick="document.getElementById('videoInput').click()"
                            >
                                ${createIcon('video')}
                                ${state.videos.length === 0 ? 'Record Video (Optional)' : 'Add More Videos'}
                            </button>

                            <p style="color: #9ca3af; font-size: 0.75rem; margin-top: 0.5rem; text-align: center;">
                                üí° Videos can replace photos - 1 360¬∞ video = all evidence needed
                            </p>
                        </div>

                        <!-- Requirements Box -->
                        <div class="requirements-box">
                            <h4 style="font-weight: bold; color: #bfdbfe; margin-bottom: 0.5rem;">üìã Requirements:</h4>
                            <ul class="requirements-list">
                                <li class="${state.photos.length >= 4 ? 'complete' : ''}">
                                    ${state.photos.length >= 4 ? '‚úì' : '‚óã'} Minimum 4 photos OR 1 video
                                </li>
                                <li class="${state.photos.length > 0 || state.videos.length > 0 ? 'complete' : ''}">
                                    ${state.photos.length > 0 || state.videos.length > 0 ? '‚úì' : '‚óã'} Clear view of all damage
                                </li>
                                <li class="${state.documents.rc && state.documents.license && state.documents.policy ? 'complete' : ''}">
                                    ${state.documents.rc && state.documents.license && state.documents.policy ? '‚úì' : '‚óã'} All required documents uploaded
                                </li>
                                <li>‚óã Capture from multiple angles</li>
                            </ul>
                        </div>

                        <!-- Document Locker Section -->
                        <div class="media-section">
                            <div class="media-header">
                                <h3 class="media-title">
                                    üîí Document Locker
                                </h3>
                                <span style="font-size: 0.875rem; color: #9ca3af;">AI Verification</span>
                            </div>

                            ${state.showDocumentChoice && !state.documents.rc && !state.documents.license && !state.documents.policy ? `
                                <div class="document-choice">
                                    <button
                                        class="btn-primary"
                                        style="width: 100%; display: flex; align-items: center; justify-content: center; gap: 0.5rem;"
                                        onclick="extractFromLocker()"
                                        ${state.extractingFromLocker ? 'disabled' : ''}
                                    >
                                        ${state.extractingFromLocker ? `
                                            <span class="spinner"></span>
                                            <span>Extracting Documents...</span>
                                        ` : `
                                            <span>üîì</span>
                                            <span>Take Documents from Locker</span>
                                        `}
                                    </button>
                                   
                                    <div class="doc-or">OR</div>
                                   
                                    <button
                                        class="btn-secondary"
                                        style="width: 100%; display: flex; align-items: center; justify-content: center; gap: 0.5rem;"
                                        onclick="state.showDocumentChoice = false; render();"
                                    >
                                        <span>üì§</span>
                                        <span>Upload Documents Manually</span>
                                    </button>
                                </div>
                            ` : ''}

                            ${(state.documents.rc || !state.showDocumentChoice) ? `
                                <div style="margin-bottom: 1rem;">
                                    <div class="flex-between" style="margin-bottom: 0.5rem;">
                                        <label class="form-label" style="margin: 0;">Registration Certificate (RC) *</label>
                                        ${state.documents.rc ? '<span class="doc-verified">‚úì AI Verified</span>' : ''}
                                    </div>
                                    ${state.documents.rc ? `
                                        <div class="document-item">
                                            <div class="document-content">
                                                <div class="doc-icon">üìÑ</div>
                                                <div style="flex: 1;">
                                                    ${state.documents.rc.extracted ? `
                                                        <p style="font-size: 0.875rem; font-weight: bold; color: #4ade80;">‚úì RC Document Extracted Successfully</p>
                                                        <p style="font-size: 0.75rem; color: #9ca3af;">${state.documents.rc.name}</p>
                                                        <p style="font-size: 0.75rem; color: #4ade80; margin-top: 0.25rem;">Vehicle registered, not blacklisted</p>
                                                    ` : `
                                                        <p style="font-size: 0.875rem; font-weight: bold;">${state.documents.rc.name}</p>
                                                        <p style="font-size: 0.75rem; color: #9ca3af;">Uploaded ${Math.floor((new Date() - state.documents.rc.timestamp) / 1000)}s ago</p>
                                                        ${state.documents.rc.verified ? '<p style="font-size: 0.75rem; color: #4ade80; margin-top: 0.25rem;">‚úì Vehicle registered, not blacklisted</p>' : ''}
                                                    `}
                                                </div>
                                            </div>
                                        </div>
                                    ` : `
                                        <input type="file" id="rcInput" accept="image/*,application/pdf" onchange="handleDocumentUpload('rc', event)" />
                                        <button class="upload-button" onclick="document.getElementById('rcInput').click()">
                                            + Upload RC
                                        </button>
                                    `}
                                </div>
                            ` : ''}

                            ${(state.documents.license || !state.showDocumentChoice) ? `
                                <div style="margin-bottom: 1rem;">
                                    <div class="flex-between" style="margin-bottom: 0.5rem;">
                                        <label class="form-label" style="margin: 0;">Driving License *</label>
                                        ${state.documents.license ? '<span class="doc-verified">‚úì AI Verified</span>' : ''}
                                    </div>
                                    ${state.documents.license ? `
                                        <div class="document-item">
                                            <div class="document-content">
                                                <div class="doc-icon">ü™™</div>
                                                <div style="flex: 1;">
                                                    ${state.documents.license.extracted ? `
                                                        <p style="font-size: 0.875rem; font-weight: bold; color: #4ade80;">‚úì Driving License Extracted Successfully</p>
                                                        <p style="font-size: 0.75rem; color: #9ca3af;">${state.documents.license.name}</p>
                                                        <p style="font-size: 0.75rem; color: #4ade80; margin-top: 0.25rem;">Current, expires 2028</p>
                                                    ` : `
                                                        <p style="font-size: 0.875rem; font-weight: bold;">${state.documents.license.name}</p>
                                                        <p style="font-size: 0.75rem; color: #9ca3af;">Uploaded ${Math.floor((new Date() - state.documents.license.timestamp) / 1000)}s ago</p>
                                                        ${state.documents.license.verified ? '<p style="font-size: 0.75rem; color: #4ade80; margin-top: 0.25rem;">‚úì Current, expires 2028</p>' : ''}
                                                    `}
                                                </div>
                                            </div>
                                        </div>
                                    ` : `
                                        <input type="file" id="licenseInput" accept="image/*,application/pdf" onchange="handleDocumentUpload('license', event)" />
                                        <button class="upload-button" onclick="document.getElementById('licenseInput').click()">
                                            + Upload License
                                        </button>
                                    `}
                                </div>
                            ` : ''}

                            ${(state.documents.policy || !state.showDocumentChoice) ? `
                                <div style="margin-bottom: 1rem;">
                                    <div class="flex-between" style="margin-bottom: 0.5rem;">
                                        <label class="form-label" style="margin: 0;">Insurance Policy *</label>
                                        ${state.documents.policy ? '<span class="doc-verified">‚úì AI Verified</span>' : ''}
                                    </div>
                                    ${state.documents.policy ? `
                                        <div class="document-item">
                                            <div class="document-content">
                                                <div class="doc-icon">üìã</div>
                                                <div style="flex: 1;">
                                                    ${state.documents.policy.extracted ? `
                                                        <p style="font-size: 0.875rem; font-weight: bold; color: #4ade80;">‚úì Insurance Policy Extracted Successfully</p>
                                                        <p style="font-size: 0.75rem; color: #9ca3af;">${state.documents.policy.name}</p>
                                                        <p style="font-size: 0.75rem; color: #4ade80; margin-top: 0.25rem;">Policy active until Dec 2026</p>
                                                    ` : `
                                                        <p style="font-size: 0.875rem; font-weight: bold;">${state.documents.policy.name}</p>
                                                        <p style="font-size: 0.75rem; color: #9ca3af;">Uploaded ${Math.floor((new Date() - state.documents.policy.timestamp) / 1000)}s ago</p>
                                                        ${state.documents.policy.verified ? '<p style="font-size: 0.75rem; color: #4ade80; margin-top: 0.25rem;">‚úì Policy active until Dec 2026</p>' : ''}
                                                    `}
                                                </div>
                                            </div>
                                        </div>
                                    ` : `
                                        <input type="file" id="policyInput" accept="image/*,application/pdf" onchange="handleDocumentUpload('policy', event)" />
                                        <button class="upload-button" onclick="document.getElementById('policyInput').click()">
                                            + Upload Policy
                                        </button>
                                    `}
                                </div>
                            ` : ''}

                            ${state.documents.rc && state.documents.license && state.documents.policy ? `
                                <div>
                                    <div class="flex-between" style="margin-bottom: 0.5rem;">
                                        <label class="form-label" style="margin: 0;">Additional Documents</label>
                                        <span style="font-size: 0.75rem; color: #6b7280;">Optional</span>
                                    </div>
                                   
                                    ${state.documents.additional.length > 0 ? `
                                        <div style="margin-bottom: 0.75rem;">
                                            ${state.documents.additional.map((doc, idx) => `
                                                <div class="document-item" style="margin-bottom: 0.5rem;">
                                                    <div class="document-content">
                                                        <div class="doc-icon">üìé</div>
                                                        <div style="flex: 1;">
                                                            <p style="font-size: 0.875rem; font-weight: bold;">${doc.customName}</p>
                                                            <p style="font-size: 0.75rem; color: #9ca3af;">${doc.name}</p>
                                                            <p style="font-size: 0.75rem; color: #4ade80; margin-top: 0.25rem;">‚úì Uploaded & AI Verified</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            `).join('')}
                                        </div>
                                    ` : ''}

                                    <button
                                        class="btn-purple"
                                        style="width: 100%;"
                                        onclick="state.showAddDocModal = true; render();"
                                    >
                                        + Add Additional Document
                                    </button>
                                </div>
                            ` : ''}

                            <div style="margin-top: 1rem; background-color: rgba(37, 99, 235, 0.3); border: 1px solid #3b82f6; border-radius: 0.5rem; padding: 0.75rem;">
                                <p style="font-size: 0.75rem; color: #bfdbfe;">
                                    üí° All documents are scanned by AI to verify authenticity and expiry dates
                                </p>
                            </div>
                        </div>

                        <div class="button-row">
                            <button class="btn-secondary" onclick="state.screen = 'details'; render();">
                                ‚Üê Back
                            </button>
                            <button
                                class="btn-green"
                                onclick="runFraudChecks()"
                                ${!canProceedFromMedia() ? 'disabled' : ''}
                            >
                                ‚ú® Run AI Checks ‚Üí
                            </button>
                        </div>
                    </div>
                </div>

                ${state.showAddDocModal ? `
                    <div class="modal-overlay">
                        <div class="modal-content">
                            <h3 style="font-size: 1.25rem; font-weight: bold; margin-bottom: 1rem;">Add Additional Document</h3>
                           
                            <div style="margin-bottom: 1rem;">
                                <label class="form-label">Document Name *</label>
                                <input
                                    type="text"
                                    class="form-input"
                                    value="${state.newDocName}"
                                    placeholder="e.g., Pollution Certificate, Tax Receipt"
                                    onchange="state.newDocName = this.value; render();"
                                    onkeyup="state.newDocName = this.value;"
                                />
                            </div>

                            <input type="file" id="additionalInput" accept="image/*,application/pdf" onchange="handleDocumentUpload('additional', event)" />

                            <div style="display: flex; gap: 0.75rem;">
                                <button
                                    class="btn-secondary"
                                    style="flex: 1;"
                                    onclick="state.showAddDocModal = false; state.newDocName = ''; render();"
                                >
                                    Cancel
                                </button>
                                <button
                                    class="btn-purple"
                                    style="flex: 1;"
                                    onclick="${state.newDocName ? "document.getElementById('additionalInput').click()" : ''}"
                                    ${!state.newDocName ? 'disabled' : ''}
                                >
                                    Upload
                                </button>
                            </div>
                        </div>
                    </div>
                ` : ''}
            `;
        }

        function renderAnalyzingScreen() {
            return `
                <div class="analyzing-screen">
                    <div style="max-width: 28rem; width: 100%;">
                        <div class="analyzing-spinner"></div>
                       
                        <h2 style="font-size: 1.875rem; font-weight: bold; margin-bottom: 0.5rem; text-align: center;">AI SCANNING...</h2>
                        <p class="text-gray-400" style="margin-bottom: 2rem; text-align: center;">Step 3 of 3</p>
                       
                        <div class="analyzing-checks">
                            <div class="check-item">
                                <div class="check-icon">${createIcon('shield')}</div>
                                <span style="font-size: 1.125rem;">Verifying GPS location...</span>
                            </div>
                            <div class="check-item">
                                <div class="check-icon">${createIcon('clock')}</div>
                                <span style="font-size: 1.125rem;">Checking media freshness...</span>
                            </div>
                            <div class="check-item">
                                <div class="check-icon">${createIcon('camera')}</div>
                                <span style="font-size: 1.125rem;">Detecting real damage...</span>
                            </div>
                        </div>

                        <div style="margin-top: 1.5rem; text-align: center; color: #9ca3af;">
                            Analyzing ${state.photos.length} photos + ${state.videos.length} videos
                        </div>
                        <div style="text-align: center; font-size: 0.875rem; color: #6b7280;">This takes 3-5 seconds</div>
                    </div>
                </div>
            `;
        }

        function renderResultScreen() {
            const result = state.result;
            const isApproved = result.status === 'approved';
            const isReview = result.status === 'review';
            const isBlocked = result.status === 'blocked';

            const bgClass = isApproved ? 'bg-gradient-green' : isReview ? 'bg-gradient-yellow' : 'bg-gradient-red';

            return `
                <div class="result-screen ${bgClass}">
                    <div style="max-width: 42rem; margin: 0 auto;">
                        <div class="text-center mb-8">
                            ${isApproved ? `
                                <div class="result-icon bounce">${createIcon('checkCircle', 'result-icon')}</div>
                                <h1 style="font-size: 3rem; font-weight: 900; color: white; margin-bottom: 0.5rem;">‚úÖ APPROVED!</h1>
                            ` : isReview ? `
                                <div class="result-icon">${createIcon('alertTriangle', 'result-icon')}</div>
                                <h1 style="font-size: 3rem; font-weight: 900; color: white; margin-bottom: 0.5rem;">üü° REVIEW</h1>
                            ` : `
                                <div class="result-icon">${createIcon('xCircle', 'result-icon')}</div>
                                <h1 style="font-size: 3rem; font-weight: 900; color: white; margin-bottom: 0.5rem;">‚ùå BLOCKED</h1>
                            `}
                            <p style="font-size: 1.5rem; color: white; opacity: 0.9;">${result.action}</p>
                        </div>

                        <div class="result-card">
                            <h3 style="font-size: 1.125rem; font-weight: bold; margin-bottom: 0.75rem;">Claim Summary</h3>
                            <div style="font-size: 0.875rem;">
                                <div class="summary-row">
                                    <span style="color: rgba(255, 255, 255, 0.7);">Name:</span>
                                    <span style="font-weight: bold;">${state.formData.name}</span>
                                </div>
                                <div class="summary-row">
                                    <span style="color: rgba(255, 255, 255, 0.7);">Vehicle:</span>
                                    <span style="font-weight: bold;">${state.formData.vehicleNumber}</span>
                                </div>
                                <div class="summary-row">
                                    <span style="color: rgba(255, 255, 255, 0.7);">Insurance:</span>
                                    <span style="font-weight: bold;">${state.formData.policyCompany}</span>
                                </div>
                                <div class="summary-row">
                                    <span style="color: rgba(255, 255, 255, 0.7);">Evidence:</span>
                                    <span style="font-weight: bold;">${state.photos.length} photos + ${state.videos.length} videos</span>
                                </div>
                            </div>
                        </div>

                        <div class="result-card">
                            <h3 style="font-size: 1.25rem; font-weight: bold; margin-bottom: 1rem;">3 Fraud Shields: ${result.checksCount}/3 Passed</h3>
                           
                            <div>
                                <div class="check-result">
                                    <div class="check-label">
                                        ${createIcon('mapPin')}
                                        <span>GPS Location Match</span>
                                    </div>
                                    <span style="font-weight: bold; color: ${result.checks.gps ? '#86efac' : '#fca5a5'};">
                                        ${result.checks.gps ? '‚úì PASS' : '‚úó FAIL'}
                                    </span>
                                </div>
                               
                                <div class="check-result">
                                    <div class="check-label">
                                        ${createIcon('clock')}
                                        <span>Fresh Media (less than 30 min)</span>
                                    </div>
                                    <span style="font-weight: bold; color: ${result.checks.freshness ? '#86efac' : '#fca5a5'};">
                                        ${result.checks.freshness ? '‚úì PASS' : '‚úó FAIL'}
                                    </span>
                                </div>
                               
                                <div class="check-result">
                                    <div class="check-label">
                                        ${createIcon('camera')}
                                        <span>Real Damage Detected</span>
                                    </div>
                                    <span style="font-weight: bold; color: ${result.checks.damage ? '#86efac' : '#fca5a5'};">
                                        ${result.checks.damage ? '‚úì PASS' : '‚úó FAIL'}
                                    </span>
                                </div>
                            </div>
                        </div>

                        <div class="result-card-white">
                            <div class="damage-cost">
                                <div style="color: #4b5563; margin-bottom: 0.5rem;">Estimated Damage</div>
                                <div class="damage-amount">‚Çπ${result.damageCost.toLocaleString()}</div>
                            </div>
                        </div>

                        ${isApproved ? `
                            <div class="result-card-white">
                                <div class="garage-info">
                                    ${createIcon('navigation', 'icon-lg')}
                                    <div style="flex: 1;">
                                        <h4 style="font-weight: bold; color: #111827; font-size: 1.125rem; margin-bottom: 0.25rem;">Garage Dispatched</h4>
                                        <p style="color: #374151; font-weight: 500;">${result.garage}</p>
                                        <p style="color: #4b5563; font-size: 0.875rem;">${result.distance} away ‚Ä¢ ETA ${result.eta}</p>
                                    </div>
                                </div>
                                <div class="alert-box">
                                    <p style="color: #166534; font-weight: bold; font-size: 0.875rem;">üí∞ Direct Payment Approved</p>
                                    <p style="color: #15803d; font-size: 0.75rem;">Insurer pays garage directly - ‚Çπ0 from your pocket</p>
                                </div>
                                <div class="tow-truck-box">
                                    <p style="color: #1e40af; font-weight: bold; font-size: 0.875rem;">${createIcon('truck')} Tow Truck Dispatched</p>
                                    <p style="color: #1d4ed8; font-size: 0.75rem;">Tow truck has been sent to your location</p>
                                </div>
                            </div>
                        ` : ''}

                        <div class="space-y-3">
                            ${isApproved ? `
                                <button class="btn-success">
                                    üéâ DONE - RELAX!
                                </button>
                            ` : ''}
                           
                            ${isReview ? `
                                <button class="btn-success" style="color: #a16207;">
                                    üìû SUPPORT CALLING (5 MIN)
                                </button>
                            ` : ''}
                           
                            ${isBlocked ? `
                                <div class="info-box">
                                    <p style="font-weight: bold; margin-bottom: 0.5rem;">Why was I blocked?</p>
                                    ${!result.checks.gps ? '<p style="font-size: 0.875rem;">‚Ä¢ You are not at the accident location</p>' : ''}
                                    ${!result.checks.freshness ? '<p style="font-size: 0.875rem;">‚Ä¢ Photos or videos are too old (take fresh ones)</p>' : ''}
                                    ${!result.checks.damage ? '<p style="font-size: 0.875rem;">‚Ä¢ AI could not detect real damage</p>' : ''}
                                </div>
                            ` : ''}

                            <button class="btn-border" onclick="window.location.href='index.html'">
                                üè† HOME
                            </button>
                        </div>

                        <div style="text-align: center; margin-top: 1.5rem; color: white; opacity: 0.75;">
                            Total time: 90 seconds ‚ö°
                        </div>
                    </div>
                </div>
            `;
        }

        // Main render function
        function render() {
            const app = document.getElementById('app');
            let content = '';

            switch(state.screen) {
                case 'emergency':
                    content = renderEmergencyScreen();
                    break;
                case 'details':
                    content = renderDetailsScreen();
                    break;
                case 'capture':
                    content = renderCaptureScreen();
                    break;
                case 'analyzing':
                    content = renderAnalyzingScreen();
                    break;
                case 'result':
                    content = renderResultScreen();
                    break;
                default:
                    content = renderEmergencyScreen();
            }

            app.innerHTML = content;
        }

        // Initial render
        render();
    </script>
</body>
</html>