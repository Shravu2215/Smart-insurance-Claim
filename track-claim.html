<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neural Status | SmartClaim AI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root { --bg-deep: #080a0f; --accent-blue: #38bdf8; --glass: rgba(255, 255, 255, 0.02); --border: rgba(255, 255, 255, 0.08); }
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: var(--bg-deep); color: white; min-height: 100vh; }
        .glass-panel { background: var(--glass); backdrop-filter: blur(40px) saturate(180%); border: 1px solid var(--border); }
        .timeline-dot { width: 14px; height: 14px; border-radius: 50%; background: #1f2937; position: relative; z-index: 10; }
        .timeline-dot.active { background: var(--accent-blue); box-shadow: 0 0 20px var(--accent-blue); }
        .timeline-dot.warning { background: #f59e0b; box-shadow: 0 0 20px #f59e0b; }
        .timeline-dot.danger { background: #ef4444; box-shadow: 0 0 20px #ef4444; }
        .timeline-line { width: 2px; background: #1f2937; position: absolute; top: 0; bottom: 0; left: 6px; z-index: 0; }
        .line-active { background: var(--accent-blue); }
        .line-warning { background: #f59e0b; }
        .line-danger { background: #ef4444; }
        
        .reason-box { background: rgba(255, 255, 255, 0.03); border: 1px solid rgba(255, 255, 255, 0.05); padding: 1rem; border-radius: 16px; margin-bottom: 0.75rem; text-align: left; font-size: 11px; color: #94a3b8; }
        .dropdown-container { background: rgba(255, 255, 255, 0.01); border: 1px solid rgba(255, 255, 255, 0.08); padding: 2rem; border-radius: 32px; margin-top: 1rem; cursor: pointer; }

        /* Chat Styles */
        .chat-bubble { padding: 0.8rem 1.2rem; border-radius: 20px; font-size: 11px; margin-bottom: 0.8rem; line-height: 1.5; }
        .ai-bubble { background: rgba(56, 189, 248, 0.1); color: #38bdf8; align-self: flex-start; border-bottom-left-radius: 4px; }
        .user-bubble { background: rgba(255, 255, 255, 0.05); color: #fff; align-self: flex-end; border-bottom-right-radius: 4px; text-align: right; }
    </style>
</head>
<body class="pb-20">

    <nav class="border-b border-white/5 backdrop-blur-xl sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-8 py-5 flex justify-between items-center">
            <div class="text-xl font-black italic uppercase">SmartClaim<span class="text-sky-400 not-italic">.Pro</span></div>
            <div class="flex items-center gap-8 text-[10px] font-extrabold uppercase tracking-widest text-gray-400">
                <a href="index.html" class="hover:text-white transition">Home</a>
                <a href="locker.html" class="text-sky-400">Track claim</a>
                <a href="submit-claim.html" class="hover:text-white transition">File Claim</a>
            </div>
        </div>
    </nav>

    <main class="max-w-6xl mx-auto px-8 mt-16 grid grid-cols-1 lg:grid-cols-3 gap-10">
        <div class="glass-panel p-10 rounded-[48px] h-fit">
            <p class="text-[10px] font-black text-gray-500 uppercase tracking-widest mb-1">Neural Verdict</p>
            <h2 id="final-verdict" class="text-2xl font-black italic uppercase">Analyzing...</h2>
            <div class="space-y-5 pt-8 mt-4 border-t border-white/5">
                <div class="flex justify-between text-sm"><span class="text-gray-500">User Amount</span><span id="user-amt-display" class="font-bold">₹0</span></div>
                <div class="flex justify-between text-sm"><span class="text-gray-500">AI Amount</span><span id="ai-amt-display" class="font-bold text-sky-400">₹0</span></div>
            </div>
        </div>

        <div class="lg:col-span-2 glass-panel p-12 rounded-[56px]">
            <h3 class="text-3xl font-black mb-12 uppercase italic tracking-tighter">Settlement <span class="text-sky-400 not-italic">Triage.</span></h3>
            <div class="relative space-y-14 ml-4">
                <div class="timeline-line"></div>
                <div class="flex gap-10 relative"><div class="timeline-dot active"></div><div><h4 class="text-xs font-black text-sky-400 uppercase tracking-widest">01. Input Received</h4></div></div>
                <div class="flex gap-10 relative"><div class="timeline-dot active"></div><div class="timeline-line h-14 -top-14 line-active"></div><div><h4 class="text-xs font-black text-sky-400 uppercase tracking-widest">02. Neural Cross-Check</h4></div></div>
                <div class="flex gap-10 relative"><div id="stage-3-dot" class="timeline-dot"></div><div id="line-3" class="timeline-line h-14 -top-14"></div><div><h4 class="text-xs font-black text-white uppercase tracking-widest opacity-40">03. Disbursement Decision</h4></div></div>
            </div>
            <div id="ai-comment" class="mt-10 p-4 bg-white/5 rounded-2xl text-[11px] text-gray-400 font-medium italic border-l-2 border-sky-400"></div>
            <div id="action-area" class="mt-14"></div>
        </div>
    </main>

    <script>
        let callTimer;
        let seconds = 0;

        // Chatbot Functionality
        let chatStep = 0;
        function handleChat() {
            const input = document.getElementById('chat-input');
            const box = document.getElementById('chat-box');
            const text = input.value.trim();
            if(!text) return;

            box.innerHTML += `<div class="chat-bubble user-bubble">${text}</div>`;
            input.value = "";
            box.scrollTop = box.scrollHeight;

            setTimeout(() => {
                let aiResponse = "";
                if (chatStep === 0) {
                    aiResponse = "Your claim is yellow because you did late reporting after 10 to 15 working days and the driver was not the owner. Also, your entered amount is much higher than our AI prediction, making it risky for immediate approval.";
                    chatStep++;
                } else {
                    aiResponse = "I understand your explanation. For the further process, you can call customer care or restart the claim process.";
                }
                box.innerHTML += `<div class="chat-bubble ai-bubble">${aiResponse}</div>`;
                box.scrollTop = box.scrollHeight;
            }, 1000);
        }

        function startManualCall() {
            const num = document.getElementById('phone-input').value;
            if(!num) { alert("Enter Number!"); return; }
            document.getElementById('call-status-box').classList.remove('hidden');
            document.getElementById('call-btn').classList.add('hidden');
            document.getElementById('end-btn').classList.remove('hidden');
            document.getElementById('status-text').innerText = "Connecting...";
            setTimeout(() => {
                document.getElementById('status-text').innerText = "CALLING IN MINUTES...";
                document.getElementById('status-text').className = "text-[10px] font-black text-sky-400 uppercase tracking-widest";
                callTimer = setInterval(() => {
                    seconds++;
                    let mins = Math.floor(seconds / 60);
                    let secs = seconds % 60;
                    document.getElementById('timer-text').innerText = (mins < 10 ? "0" + mins : mins) + ":" + (secs < 10 ? "0" + secs : secs);
                }, 1000);
            }, 1500);
        }

        function endManualCall() {
            clearInterval(callTimer);
            seconds = 0;
            document.getElementById('status-text').innerText = "Call Terminated";
            document.getElementById('status-text').className = "text-[10px] font-black text-red-500 uppercase tracking-widest";
            setTimeout(() => {
                document.getElementById('call-status-box').classList.add('hidden');
                document.getElementById('call-btn').classList.remove('hidden');
                document.getElementById('end-btn').classList.add('hidden');
            }, 2000);
        }

        window.onload = function() {
            const userAmt = parseInt(localStorage.getItem('claimedAmount') || 0); 
            const verdict = document.getElementById('final-verdict');
            const actionArea = document.getElementById('action-area');
            const aiComment = document.getElementById('ai-comment');
            let aiAmt = 0;

            if (userAmt >= 200000) {
                aiAmt = 35000;
                verdict.innerText = "RED FLAG";
                verdict.className = "text-2xl font-black italic text-red-500 uppercase";
                aiComment.innerText = "Critical anomalies found. Execution halted.";
                document.getElementById('stage-3-dot').className = "timeline-dot danger";
                document.getElementById('line-3').className = "timeline-line h-14 -top-14 line-danger";
                actionArea.innerHTML = `
                    <div class="dropdown-container" onclick="document.getElementById('red-reasons').classList.toggle('hidden')">
                        <div class="flex justify-between items-center mb-6">
                            <span class="text-[10px] font-black uppercase text-red-500 tracking-widest">REJECTION REASONS</span>
                            <span class="text-[9px] font-bold text-gray-500 uppercase">EXPAND ▼</span>
                        </div>
                        <div id="red-reasons" class="hidden">
                            <div class="reason-box italic">• Claim amount exceeds safety threshold.</div>
                            <div class="reason-box italic">• High Fraud Score: 82/100.</div>
                            <div class="reason-box italic">• Policy document expired.</div>
                            <div class="reason-box italic">• Missing important document(RC).</div>
                        </div>
                    </div>
                    <button onclick="document.getElementById('call-panel').classList.toggle('hidden')" class="w-full mt-4 bg-white/5 border border-white/10 py-5 rounded-3xl text-[10px] font-black uppercase tracking-widest hover:bg-red-500 hover:text-white transition">More Enquiry Option</button>
                    <div id="call-panel" class="hidden p-8 bg-white/5 border border-white/10 rounded-[36px] space-y-4 mt-4 text-center">
                        <p class="text-[10px] font-black text-gray-500 uppercase text-center tracking-widest">ENTER YOUR NUMBER</p>
                        <input type="text" id="phone-input" placeholder="+91" class="w-full bg-black/40 border border-white/10 p-4 rounded-2xl text-center font-mono">
                        <p class="text-[10px] font-black text-gray-500 uppercase text-center tracking-widest">NOTE: YOU WILL RECEIVE CALL WITHIN 2 MINUTES</p>
                        <div class="flex gap-2">
                            <button id="call-btn" onclick="startManualCall()" class="flex-1 bg-sky-500 text-black font-black py-4 rounded-xl text-[10px] uppercase">Call Officer</button>
                            <button id="end-btn" onclick="endManualCall()" class="hidden flex-1 bg-red-500 text-white font-black py-4 rounded-xl text-[10px] uppercase">End Call</button>
                        </div>
                        <div id="call-status-box" class="hidden flex flex-col items-center justify-center p-10 bg-black/60 rounded-[32px] border border-white/5 min-h-[150px]">
                            <div id="status-text" class="text-[10px] font-black uppercase text-center mb-2"></div>
                            <div id="timer-text" class="text-3xl font-black font-mono">00:00</div>
                        </div>
                    </div>`;
            }
            else if (userAmt >= 50000) {
                aiAmt = 25000;
                verdict.innerText = "YELLOW FLAG";
                verdict.className = "text-2xl font-black italic text-yellow-500 uppercase";
                aiComment.innerText = "Manual Triage Required. System detected high-variance parameters.";
                document.getElementById('stage-3-dot').className = "timeline-dot warning";
                document.getElementById('line-3').className = "timeline-line h-14 -top-14 line-warning";
                
                // Toggle Logic for Chat/Call
                actionArea.innerHTML = `
                    <div class="dropdown-container" onclick="document.getElementById('yellow-reasons').classList.toggle('hidden')">
                        <div class="flex justify-between items-center mb-6">
                            <span class="text-[10px] font-black uppercase text-yellow-500 tracking-widest">FLAGGED DISCREPANCIES</span>
                            <span class="text-[9px] font-bold text-gray-500 uppercase">EXPAND ▼</span>
                        </div>
                        <div id="yellow-reasons" class="hidden">
                            <div class="reason-box italic">• Manual check for claim value: ₹50,000.</div>
                            <div class="reason-box italic">• Fraud Score: 55/100 requires oversight.</div>
                            <div class="reason-box italic">• Late reporting more than 10 days.</div>
                            <div class="reason-box italic">• Driver not the policy owner.</div>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-4 mt-6">
                        <button onclick="document.getElementById('chat-section').classList.remove('hidden'); document.getElementById('call-panel').classList.add('hidden')" class="bg-white/5 border border-white/10 py-5 rounded-3xl text-[10px] font-black uppercase tracking-widest hover:bg-yellow-500 hover:text-black transition">Chat</button>
                        <button onclick="document.getElementById('call-panel').classList.remove('hidden'); document.getElementById('chat-section').classList.add('hidden')" class="bg-white/5 border border-white/10 py-5 rounded-3xl text-[10px] font-black uppercase tracking-widest hover:bg-yellow-500 hover:text-black transition">Call</button>
                    </div>

                    <div id="chat-section" class="hidden mt-6 p-6 glass-panel rounded-[32px] flex flex-col">
                        <div id="chat-box" class="h-48 overflow-y-auto mb-4 flex flex-col p-2 bg-black/20 rounded-xl">
                            <div class="chat-bubble ai-bubble">Hi! How do I help you?</div>
                        </div>
                        <div class="flex gap-2">
                            <input id="chat-input" type="text" placeholder="Type message..." class="flex-1 bg-black/40 border border-white/10 p-3 rounded-xl text-xs outline-none">
                            <button onclick="handleChat()" class="bg-sky-500 text-black px-4 rounded-xl font-bold text-[10px]">SEND</button>
                        </div>
                    </div>

                    <div id="call-panel" class="hidden p-8 bg-white/5 border border-white/10 rounded-[36px] space-y-4 mt-4 text-center">
                        <p class="text-[10px] font-black text-gray-500 uppercase text-center tracking-widest">ENTER YOUR NUMBER</p>
                        <input type="text" id="phone-input" placeholder="+91" class="w-full bg-black/40 border border-white/10 p-4 rounded-2xl text-center font-mono">
                        <p class="text-[10px] font-black text-gray-500 uppercase text-center tracking-widest">NOTE: YOU WILL RECEIVE CALL IN 2 MINUTES</p>
                        <div class="flex gap-2">
                            <button id="call-btn" onclick="startManualCall()" class="flex-1 bg-sky-500 text-black font-black py-4 rounded-xl text-[10px] uppercase">Initialize Call</button>
                            <button id="end-btn" onclick="endManualCall()" class="hidden flex-1 bg-red-500 text-white font-black py-4 rounded-xl text-[10px] uppercase">End Call</button>
                        </div>
                        <div id="call-status-box" class="hidden flex flex-col items-center justify-center p-10 bg-black/60 rounded-[32px] border border-white/5 min-h-[150px]">
                            <div id="status-text" class="text-[10px] font-black uppercase text-center mb-2"></div>
                            <div id="timer-text" class="text-3xl font-black font-mono">00:00</div>
                        </div>
                    </div>`;
            }
            else {
                aiAmt = 15000;
                verdict.innerText = (userAmt <= 12000) ? "Green + User Wins" : "PROCEED TO PAYOUT";
                verdict.className = "text-2xl font-black italic text-green-500 uppercase";
                aiComment.innerText = (userAmt <= 12000) ? "Honest user! Paying your ₹15K request." : "Validation success. Within ±15% tolerance.";
                document.getElementById('stage-3-dot').className = "timeline-dot active";
                document.getElementById('line-3').className = "timeline-line h-14 -top-14 line-active";
                actionArea.innerHTML = `<button onclick="window.location.href='payout.html'" class="w-full bg-green-500 text-white font-black py-6 rounded-[30px] uppercase text-[11px]">Collect Disbursement</button>`;
            }

            document.getElementById('user-amt-display').innerText = "₹" + userAmt.toLocaleString();
            document.getElementById('ai-amt-display').innerText = "₹" + aiAmt.toLocaleString();
        }
    </script>
</body>
</html>